#include <stdio.h>
#include <stdint.h>
#include <stdlib.h>
#include <fcntl.h>
#include <unistd.h>

uint8_t bytes[] = { 
#if 1
   0,
#else
   0xf6, 0xf6, 0xf6, 0xf6, 0xf6, 0xf6, 0xb6, 0xf6, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36,
   0x36, 0x36, 0xb6, 0x36, 0x36, 0x36, 0x36, 0x36, 0xb6, 0x36, 0x36, 0xb6, 0x36, 0xb6, 0x36, 0x36,
   0x36, 0x36, 0xb6, 0xb6, 0xb6, 0x36, 0x36, 0x36, 0x36, 0x36, 0x76, 0x36, 0xf2, 0x76, 0xe2, 0x62,
   0x62, 0x62, 0xf2, 0x62, 0x72, 0x72, 0x73, 0x72, 0x3b, 0x3b, 0x3b, 0x3b, 0x3b, 0x3b, 0x3b, 0x3b,

   0xf6, 0xf6, 0xf6, 0xf6, 0xf6, 0xf6, 0xb6, 0xf6, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36, 0x36,
   0x36, 0x36, 0xb6, 0x36, 0x36, 0x36, 0x36, 0x36, 0xb6, 0x36, 0x36, 0xb6, 0x36, 0xb6, 0x36, 0x36,
   0x36, 0x36, 0xb6, 0xb6, 0xb6, 0x36, 0x36, 0x36, 0x36, 0x36, 0x76, 0x36, 0xf2, 0x76, 0xe2, 0x62,
   0x62, 0x62, 0xf2, 0x62, 0x72, 0x72, 0x73, 0x72, 0x3b, 0x3b, 0x3b, 0x3b, 0x3b, 0x3b, 0x3b, 0x3b,

   0xc0, 0xc4, 0xc0, 0xc4, 0xc0, 0xc4, 0x84, 0xc4, 0x04, 0x04, 0x84, 0x04, 0x04, 0x04, 0x04, 0x04,
   0x04, 0x84, 0x04, 0x04, 0x04, 0x04, 0x84, 0x84, 0x04, 0x04, 0x84, 0x84, 0x04, 0x04, 0x04, 0x84,
   0x04, 0x04, 0x84, 0x04, 0x04, 0x04, 0x04, 0x04, 0x14, 0x04, 0x54, 0x14, 0x50, 0xd4, 0xc0, 0x40,
   0x40, 0x40, 0x40, 0xc0, 0x40, 0x40, 0x41, 0x40, 0x3b, 0x3b, 0x3b, 0x3b, 0x3b, 0x3b, 0x3b, 0x3b,

   0xd2, 0xd6, 0xd2, 0xd6, 0xd2, 0xd6, 0x92, 0xd6, 0x12, 0x16, 0x92, 0x16, 0x12, 0x16, 0x12, 0x16,
   0x12, 0x96, 0x12, 0x16, 0x12, 0x16, 0x92, 0x96, 0x12, 0x16, 0x92, 0x96, 0x12, 0x16, 0x12, 0x96,
   0x12, 0x12, 0x92, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x12, 0x52, 0x12, 0x52, 0xd2, 0xc2, 0x42,
   0x42, 0x42, 0x52, 0xc2, 0x52, 0x52, 0x5b, 0x52, 0x3b, 0x3b, 0x3b, 0x3b, 0x3b, 0x3b, 0x3b, 0x3b
#endif
};

int main(int argc, char **argv) {
  if (argc != 2) {
    printf("Usage: %s filename\n", argv[0]);
    exit(1);
  }

  int fd = open(argv[1], O_RDONLY);
  if (fd < 0) {
    perror("open");
    exit(2);
  }

  int nbytes = read(fd, bytes, 256);
  if (nbytes != 256) {
    printf("Could only read %d bytes\n", nbytes);
    exit(3);
  }

  for (int bit = 0; bit < 8; bit++) {
    printf("bit %d = \n", bit);
    for (int n = 0; n < 256; n++) {
      printf("%d", (bytes[n] & (1<<bit))?1:0);
      if (((n+1) %  2) == 0) printf(" ");
      if (((n+1) %  4) == 0) printf(" ");
      if (((n+1) % 16) == 0) {
#if 0
        printf(" - ");
        for (int i=0; i<16; i++) printf("%02x ", bytes[n-15+i]);
#endif
        printf("\n");
      }
      if (((n+1) % 64) == 0) {
        printf("\n");
      }
    }
    printf("\n\n");
  }
}

